<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title th:text="${title}"></title>
	<script th:src="@{/vendors/jquery/dist/jquery.min.js}"></script>
	<script th:src="@{/vendors/boostrap/dist/js/boostrap.min.js}"></script>
	<!-- popper js -->
	<script src="https://unpkg.com/@popperjs/core@2"></script>
	<link th:href="@{/vendors/bootstrap/dist/css/bootstrap.min.css}" rel="stylesheet">

	<link th:href="@{/vendors/font-awesome/css/font-awesome.min.css}" rel="stylesheet">

	<link th:href="@{/vendors/nprogress/nprogress.css}" rel="stylesheet">

	<link th:href="@{/vendors/animate.css/animate.min.css}" rel="stylesheet">

	<link th:href="@{/build/css/custom.min.css}" rel="stylesheet">

	<meta name="robots" content="noindex, follow">
	<script
		nonce="8f0474b8-4ce6-44f5-88d9-7b270635e12e">(function (w, d) {!function (bv, bw, bx, by) {bv[bx] = bv[bx] || {}; bv[bx].executed = []; bv.zaraz = {deferred: [], listeners: []}; bv.zaraz.q = []; bv.zaraz._f = function (bz) {return function () {var bA = Array.prototype.slice.call(arguments); bv.zaraz.q.push({m: bz, a: bA})}}; for (const bB of ["track", "set", "debug"]) bv.zaraz[bB] = bv.zaraz._f(bB); bv.zaraz.init = () => {var bC = bw.getElementsByTagName(by)[0], bD = bw.createElement(by), bE = bw.getElementsByTagName("title")[0]; bE && (bv[bx].t = bw.getElementsByTagName("title")[0].text); bv[bx].x = Math.random(); bv[bx].w = bv.screen.width; bv[bx].h = bv.screen.height; bv[bx].j = bv.innerHeight; bv[bx].e = bv.innerWidth; bv[bx].l = bv.location.href; bv[bx].r = bw.referrer; bv[bx].k = bv.screen.colorDepth; bv[bx].n = bw.characterSet; bv[bx].o = (new Date).getTimezoneOffset(); if (bv.dataLayer) for (const bI of Object.entries(Object.entries(dataLayer).reduce(((bJ, bK) => ({...bJ[1], ...bK[1]}))))) zaraz.set(bI[0], bI[1], {scope: "page"}); bv[bx].q = []; for (; bv.zaraz.q.length;) {const bL = bv.zaraz.q.shift(); bv[bx].q.push(bL)} bD.defer = !0; for (const bM of [localStorage, sessionStorage]) Object.keys(bM || {}).filter((bO => bO.startsWith("_zaraz_"))).forEach((bN => {try {bv[bx]["z_" + bN.slice(7)] = JSON.parse(bM.getItem(bN))} catch {bv[bx]["z_" + bN.slice(7)] = bM.getItem(bN)} })); bD.referrerPolicy = "origin"; bD.src = "/cdn-cgi/zaraz/s.js?z=" + btoa(encodeURIComponent(JSON.stringify(bv[bx]))); bC.parentNode.insertBefore(bD, bC)};["complete", "interactive"].includes(bw.readyState) ? zaraz.init() : bv.addEventListener("DOMContentLoaded", zaraz.init)}(w, d, "zarazData", "script");})(window, document);</script>
<style>
.fa-eye, .fa-eye-slash{
	position: absolute;
	right: 13px;
    top: 11px;
}
#eyeIcon:hover{
	cursor: pointer;
}
#signUp{
	margin-top:30px; 
	width:100%; 
	border: 1px solid #73879C; 
	color: #73879C; 
	border-radius: 3px;
}
#signUp:hover{
	box-shadow: 0 0 0 0.2rem rgba(0,123,255,.25);
}
</style>
</head>

<body class="login">
	<div>
		<a class="hiddenanchor" id="signup"></a> <a class="hiddenanchor" id="signin"></a>
		<div class="login_wrapper">
			<div class="animate form login_form">
				<section class="login_content" id="loginContent_login">
					<form id="loginSubmitForm" th:action="@{/login}" method="post">
						<h1>로그인</h1>
						<!-- 여기는 관리자/회원 로그인 나누는것 -->
						<ul class="nav nav-tabs" id="myTab" role="tablist" style="margin-bottom: 20px;">
							<li class="nav-item"><a class="nav-link active" id="normal" data-toggle="tab" role="tab"
									aria-controls="home" aria-selected="true">일반회원</a></li>
							<li class="nav-item"><a class="nav-link" id="admin" data-toggle="tab" role="tab"
									aria-controls="profile" aria-selected="false">관리자</a></li>
						</ul>
						<input type="hidden" id="loginLevel" name="loginLevel"/>
						<div>
							<input type="text" id="memberId" class="form-control" placeholder="Username" required
								name="memberId" value="dry_id_1" />
						</div>
						<div>
							<input type="password" id="memberPw" class="form-control" placeholder="Password" required
								name="memberPw" value="drypw1" />
						</div>

						<div style="color: red; display: none;" id="invalidPwWarning">
							The ID or password you entered is incorrect.</div>
						<div>
							<button type="button" id="dry_login">건조업체</button>
							<button type="button" id="farm_mentor_login">사육장 멘토 대표자</button>
							<button type="button" id="farm_mentee_login">사육장 멘티</button>
							<button type="button" id="farm_none_login">사육장</button>
							<button type="button" id="buy_login">구매업체</button>
							<button type="button" id="new_login">준회원</button>
							<button type="button" id="admin_login">관리자</button>
						</div>
						<div>
							<a class="btn btn-default submit" id="loginSubmit" href="#">Log in</a> <a
								class="btn reset_pass submit" style="text-decoration: none;">Lost
								your password?</a>
						</div>
						<div class="clearfix"></div>
						<div class="separator">
							<p class="change_link">
								New to site? <a href="#signup" class="to_register" id="toSignUp"> Create
									Account </a>
							</p>
							<div class="clearfix"></div>
							<br />
							<div>
								<h1>
									<i class="fa fa-paw"></i> Gentelella Alela!
								</h1>
								<p>©2016 All Rights Reserved. Gentelella Alela! is a
									Bootstrap 3 template. Privacy and Terms</p>
							</div>
						</div>
					</form>
				</section>
			</div>
			<div id="register" class="animate form registration_form">
				<section class="login_content" id="loginContent_signUp">
					<form th:action="@{/}" method="post" id="signUpForm">
						<h1>웰컴투 동애등에</h1>
						<div>
							<input type="text" class="form-control" placeholder="아이디" value="id0000" required="" id="idSignUp" />
						</div>
						<span id="idMsg"></span>
						<div>
							<input type="email" class="form-control" placeholder="이메일" value="p315315@gmail.com" required="" id="emailSignUp" />
							<span id="emailMsg"></span>
						</div>
						<div style="position:relative;">
							<input type="password" class="form-control" placeholder="비밀번호" value="sadfasdf12" required="" id="pwSignUp"/ >
							<i id="eyeIcon" class="fa fa-eye"></i>		
							<span id="pwMsg"></span>
						</div>
						<div>
							<input type="text" class="form-control" placeholder="이름" value="박민서" required="" id="nameSignUp"/>
						</div>
						<div>
							<input type="tel" class="form-control" placeholder="전화번호" value="01011111111" required="" pattern="[0-9]{11}" id="telSignUp"/>
						</div>
						<div>
							<button type="submit" class="btn btn-default submit" id="signUp" style="" >회원가입</button>
						</div>
						<div class="clearfix"></div>
						<div class="separator">
							<p class="change_link">
								Already a member ? <a href="#signin" class="to_register" id="toLogin">
									Log in </a>
							</p>
							<div class="clearfix"></div>
							<br />
							<div>
								<h1>
									<i class="fa fa-paw"></i> Gentelella Alela!
								</h1>
								<p>©2016 All Rights Reserved. Gentelella Alela! is a
									Bootstrap 3 template. Privacy and Terms</p>
							</div>
						</div>
					</form>
				</section>
			</div>
		</div>
	</div>
	<script defer
		src="https://static.cloudflareinsights.com/beacon.min.js/vb26e4fa9e5134444860be286fd8771851679335129114"
		integrity="sha512-M3hN/6cva/SjwrOtyXeUa5IuCT0sedyfT+jK/OV+s+D0RnzrTfwjwJHhd+wYfMm9HJSrZ1IKksOdddLuN6KOzw=="
		data-cf-beacon='{"rayId":"7b377b62dd4e19dc","token":"cd0b4b3a733644fc843ef0b185f98241","version":"2023.3.0","si":100}'
		crossorigin="anonymous"></script>
	<script>
		let idRegExp = /^[a-zA-Z][a-z0-9A-Z-_.]{5,19}$/;
		let emailRegExp = new RegExp(/(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))/);
		let pwRegExp = /^(?=.*[0-9])(?=.*[a-zA-Z])[a-zA-Z0-9!@#$%^&*()._-]{6,16}$/;
		let emailValidationFn = function(string){
			return emailRegExp.test(string);
		}
		//사용안하는중
		let timeFormatFn = function(time){
			let minutes = Math.floor(time/60);
			let seconds = time%60;
			return `${minutes}:${seconds}`
		}
		
		//비밀번호 체크
		//- 6자 이상 16자 이하, 영어와 숫자의 조합으로 구성
		
		$(function(){
			//패스워드 체크
			let pwValidFn = function(){
				let pw = $('#pwSignUp').val();
				if(pwRegExp.test(pw)){
					$('#pwMsg').text('멋진비밀번호 입니다.').css('color','green');
					return true;
				} else {
					$('#pwMsg').text('6자 이상 16자 이하, 영어와 숫자의 조합으로 구성되어야 합니다');
					return false;
				}
			}
			//회원가입 버튼 disabled 처리
			let emailSignUpValidFn = function(){
				const email = $('#emailSignUp').val();
				/* console.log(email); */
				const msgSpan = $('#emailMsg');
				
				const isEmailValid = emailValidationFn(email);
				if(email == '' || email == null || email == undefined){
					$(msgSpan).text('필수항목입니다').css('color','red');
					return false;
				}
				else if(!isEmailValid){
					$(msgSpan).text('유효하지 않거나 사용중인 이메일 입니다.').css('color', 'red');
					return false;
				} else {
					let valid = false;
					let request = $.ajax({
						url: "/isEmailUsed?email="+email,
						method: "get",
						datatype: 'json',
						async: false
					}).done(function(data){
						if(data){
							$(msgSpan).text('유효하지 않거나 사용중인 이메일 입니다.').css('color','red');
							valid = false;
						} else {
							$(msgSpan).text('멋진 이메일 입니다.').css('color','green');
							valid = true;
						}
					})
					return valid;
				}
				/* console.log(isEmailValid); */
			};
			
			//id 체크
			let idValidFn = function(){
				$('#idMsg').text('');
				let memberId = $('#idSignUp').val();
				console.log(memberId);
				let regTest = idRegExp.test(memberId);
				if(memberId == '' || memberId=='null' || memberId==undefined){
					$('#idMsg').text('필수 항목입니다').css('color', 'red');
					return false;
				} else if(regTest){
					let valid = false;
					let request = $.ajax({
						url: "/isDuplicateId",
						method: "POST",
						data: {
							'memberId' : memberId
						},
						dataType: "json",
						async: false
					}).done(function(isDuplicateId){
						//if duplicate
						if(isDuplicateId){
							$('#idMsg').text('이미 사용중이거나 탈퇴한 아이디입니다.').css('color', 'red');
							valid = false;
						} else {
							$('#idMsg').text('멋진 아이디 입니다!').css('color', 'green');
							valid = true;
						}
					})
					return valid;
				} else {
					$('#idMsg').text('6~20자의 영문 소문자, 대문자, 숫자와 특수기호(_),(-),(.)만 사용 가능합니다.').css('color', 'red');
					return false;
				}
				
				
			}
			
			//password 보이기 처리
			$(".fa.fa-eye").click(function(){
				$('#pwSignUp').attr('type',function(index, attr){
					return attr == 'password' ? 'text' : 'password';
				})
				let typeVal = $('#pwSignUp').attr('type');
				let eyeIconEle = $('#eyeIcon');
				$(eyeIconEle).toggleClass('fa-eye');
				$(eyeIconEle).toggleClass('fa-eye-slash');
			})
			
			//이메일 인증 변경 필요 - validation 체크로 변경, 인증번호는 다음으로 넘어가는 페이지에서 처리예정
			
			$('#emailSignUp').blur(emailSignUpValidFn);
			
			// 회원가입 input form 아이디 중복체크
			$('#idSignUp').blur(idValidFn);
			//패스워드 폼 이벤트
			$('#pwSignUp').blur(pwValidFn);
			
			let validationAll = function(){
				console.log(emailSignUpValidFn());
				console.log(pwValidFn());
				console.log(idValidFn());
				return emailSignUpValidFn() && idValidFn() && pwValidFn();
			}
			$('#signUpForm').submit(validationAll);
			
			//로드시 안보이는 페이지가 바로 옆에 hidden으로 밖에 안되서 안보여도 클릭이됨
			const url = location.href.split('#');
			console.log(url);
			$('#loginContent_signUp').css('pointer-events','');
			$('#loginContent_login').css('pointer-events','');
			
			if(url[url.length-1] === 'signup'){
				$('#loginContent_login').css('pointer-events','none');
				$('#loginContent_signUp').css('pointer-events','');
			}else{
				$('#loginContent_signUp').css('pointer-events','none');
				$('#loginContent_login').css('pointer-events','');
			}
			$('#toSignUp').click(function(){
				$('#loginContent_login').css('pointer-events','none');
				$('#loginContent_signUp').css('pointer-events','');
			})
			$('#toLogin').click(function(){
				$('#loginContent_signUp').css('pointer-events','none');
				$('#loginContent_login').css('pointer-events','');
			})
			//로그인 ajax 체크
			$('#loginSubmit').click(function(){
				$('#invalidPwWarning').css('display', 'none');
				let loginLevel = $('.nav-link.active').attr('id');
				$('#loginLevel').val(loginLevel);
				$('#loginSubmitForm').submit();
			});
			//로그인하려는 권한 체크 - 일반회원/관리자
			let navTabs = $('a.nav-link');

			$('#normal').click(function () {
				navTabs.each(function (idx, item) {
					$(item).removeClass('active');
					$(item).attr('aria-selected', 'false')
				});
				$(this).addClass('active');
				$(this).attr('aria-selected', 'true');
			});

			$('#admin').click(function () {
				navTabs.each(function (idx, item) {
					$(item).removeClass('active');
					$(item).attr('aria-selected', 'false')
				});
				$(this).addClass('active');
				$(this).attr('aria-selected', 'true');
			});
			//dry, farm, buy, new, admin 버튼 클릭시 연동되있는 어카운트로 자동 로그인
			let idInput = $('#memberId');
			let pwInput = $('#memberPw');
			$('#dry_login').click(function () {
				$('#loginLevel').val("normal");
				$(idInput).val('dry_id_1');
				$(pwInput).val('drypw1');

				$('#loginSubmitForm').submit();
			})
			$('#farm_mentor_login').click(function () {
				$('#loginLevel').val("normal");
				idInput.val('farm_id_1');
				pwInput.val('pw1');
				$('#loginSubmitForm').submit();
			})
			$('#farm_mentee_login').click(function () {
				$('#loginLevel').val("normal");
				idInput.val('farm_id_6');
				pwInput.val('pw6');
				$('#loginSubmitForm').submit();
			})
			$('#farm_none_login').click(function () {
				$('#loginLevel').val("normal");
				idInput.val('farm_id_31');
				pwInput.val('pw31');
				$('#loginSubmitForm').submit();
			})
			$('#buy_login').click(function () {
				$('#loginLevel').val("normal");
				idInput.val('feed_id_1');
				pwInput.val('feedpw01');
				$('#loginSubmitForm').submit();
			})
			$('#new_login').click(function () {
				$('#loginLevel').val("normal");
				idInput.val('farm_id_33');
				pwInput.val('pw33');
				$('#loginSubmitForm').submit();
			})
			$('#admin_login').click(function () {
				$('#loginLevel').val("admin");
				idInput.val('admin_1');
				pwInput.val('admin_pw1');
				$('#loginSubmitForm').submit();
			})
			
			
		})

	</script>

</body>

</html>